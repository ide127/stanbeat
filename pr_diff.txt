diff --git a/App.tsx b/App.tsx
index dd9620b..0865d6b 100644
--- a/App.tsx
+++ b/App.tsx
@@ -3,14 +3,14 @@ import { ArrowLeft, Clipboard, ClipboardCheck, DollarSign, Play, RefreshCw, Sett
 import { Layout, Modal } from './components/Layout';
 import { languageOptions, t } from './i18n';
 import { useStore, detectLanguageFromIP, type AdConfig } from './store';
-import { GridCell, WordConfig } from './types';
+import { GridCell, WordConfig, HistoryEvent } from './types';
 import confetti from 'canvas-confetti';
-import { formatTime, generateGrid, getCountryFlag, getSolutionCells, playSfx } from './utils';
+import { formatTime, generateGrid, getCountryFlag, getSolutionCells } from './utils';
 import { getCurrentSeasonNumber, generateGuestShowcase } from './league';
 
 const TARGET_WORDS = ['RM', 'JIN', 'SUGA', 'HOPE', 'JIMIN', 'V', 'JK'];
 
-const vibrate = () => { navigator.vibrate?.(15); playSfx('tap'); };
+const vibrate = () => navigator.vibrate?.(15);
 
 // â”€â”€â”€ Home Screen â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 // â”€â”€â”€ í™ˆ í™”ë©´ ì»´í¬ë„ŒíŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
@@ -20,10 +20,10 @@ const HomeScreen = ({ onShowHearts }: { onShowHearts: () => void }) => {
   const { setView, consumeHeart, currentUser, login, language, termsAccepted, acceptTerms, seasonEndsAt, notice, showNoticePopup, setShowNoticePopup } = useStore();
   const [showLoginModal, setShowLoginModal] = useState(false);
   const [showTermsModal, setShowTermsModal] = useState(false);
+  const [termsChecked, setTermsChecked] = useState(true);
   const [showNoticeModal, setShowNoticeModal] = useState(false);
   const [rewardIndex, setRewardIndex] = useState(0);
   const [transitioning, setTransitioning] = useState(false);
-  const [isLoggingIn, setIsLoggingIn] = useState(false);
   const [remainingParts, setRemainingParts] = useState({ h: 0, m: 0, s: 0, ms: 0 });
 
   // Show notice popup on mount if enabled
@@ -33,6 +33,12 @@ const HomeScreen = ({ onShowHearts }: { onShowHearts: () => void }) => {
     }
   }, [showNoticePopup, notice]);
 
+  useEffect(() => {
+    if (showTermsModal) {
+      setTermsChecked(true);
+    }
+  }, [showTermsModal]);
+
   useEffect(() => {
     const interval = setInterval(() => setRewardIndex((prev) => (prev + 1) % 3), 1800);
     return () => clearInterval(interval);
@@ -141,17 +147,6 @@ const HomeScreen = ({ onShowHearts }: { onShowHearts: () => void }) => {
         </div>
       </button>
 
-      {useStore.getState().deferredPrompt && (
-        <button onClick={() => {
-          vibrate();
-          const promptEvent = useStore.getState().deferredPrompt;
-          promptEvent.prompt();
-          promptEvent.userChoice.then(() => useStore.setState({ deferredPrompt: null }));
-        }} className="w-full mt-3 bg-[#00FFFF]/20 border border-[#00FFFF]/50 text-[#00FFFF] font-bold py-3 rounded-xl btn-squishy flex items-center justify-center gap-2">
-          ğŸ“± Install App for Best Experience
-        </button>
-      )}
-
       <div className="mt-4 rounded-xl overflow-hidden border border-white/10 bg-black/30">
         <img src={rewardImages[rewardIndex]} alt="reward" className="w-full h-24 object-cover" />
         <p className="text-white/80 text-xs py-2">{t(language, 'rewardText')}</p>
@@ -192,21 +187,9 @@ const HomeScreen = ({ onShowHearts }: { onShowHearts: () => void }) => {
       <Modal isOpen={showLoginModal} onClose={() => setShowLoginModal(false)} title={t(language, 'loginRequired')}>
         <p className="text-white/70 text-sm mb-4">{t(language, 'loginPrompt')}</p>
         <button
-          disabled={isLoggingIn}
-          onClick={async () => {
-            if (isLoggingIn) return;
-            setIsLoggingIn(true);
-            vibrate();
-            try {
-              await login();
-              setShowLoginModal(false);
-            } finally {
-              setIsLoggingIn(false);
-            }
-          }}
-          className="w-full bg-white text-black font-bold py-3 rounded-xl btn-squishy disabled:opacity-50 flex justify-center items-center gap-2"
+          onClick={() => { vibrate(); login().then(() => setShowLoginModal(false)); }}
+          className="w-full bg-white text-black font-bold py-3 rounded-xl btn-squishy"
         >
-          {isLoggingIn ? <span className="animate-spin text-xl">â†»</span> : null}
           {t(language, 'continueGoogle')}
         </button>
       </Modal>
@@ -217,12 +200,13 @@ const HomeScreen = ({ onShowHearts }: { onShowHearts: () => void }) => {
           <pre className="text-white/60 text-[11px] whitespace-pre-wrap font-sans leading-relaxed">{t(language, 'termsFullText')}</pre>
         </div>
         <label className="flex items-start text-white/80 text-sm gap-2 mb-4 text-left">
-          <input type="checkbox" defaultChecked />
+          <input type="checkbox" checked={termsChecked} onChange={(e) => setTermsChecked(e.target.checked)} />
           {t(language, 'termsAgree')}
         </label>
         <button
           onClick={() => { vibrate(); acceptTerms(); setShowTermsModal(false); }}
-          className="w-full bg-[#00FFFF] text-black font-bold py-2 rounded-lg btn-squishy"
+          disabled={!termsChecked}
+          className="w-full bg-[#00FFFF] text-black font-bold py-2 rounded-lg btn-squishy disabled:opacity-40 disabled:cursor-not-allowed"
         >
           {t(language, 'termsAccept')}
         </button>
@@ -230,7 +214,7 @@ const HomeScreen = ({ onShowHearts }: { onShowHearts: () => void }) => {
 
       {/* Notice Popup */}
       <Modal isOpen={showNoticeModal} onClose={() => setShowNoticeModal(false)} title={t(language, 'noticeTitle')}>
-        <p className="text-white/70 text-sm whitespace-pre-wrap">{notice}</p>
+        <p className="text-white/70 text-sm">{notice}</p>
       </Modal>
     </div>
   );
@@ -245,7 +229,7 @@ const TimerDisplay = ({ startMs, won, setElapsedState }: { startMs: number; won:
     const update = () => {
       const current = Date.now() - startMs;
       setVal(current);
-      setElapsedState(current); // Pass back to parent ONLY when won
+      setElapsedState(current);
     };
     const timer = setInterval(update, 10);
     return () => clearInterval(timer);
@@ -269,7 +253,7 @@ const GameScreen = ({ onShowHearts }: { onShowHearts: () => void }) => {
   const [startId, setStartId] = useState<string | null>(null);
   const [elapsed, setElapsed] = useState(0);
   const [won, setWon] = useState(false);
-  const startMs = useState(Date.now())[0];
+  const startMsRef = useRef(Date.now());
   const placementRef = useRef<{ word: string; row: number; col: number; dir: { r: number; c: number } }[]>([]);
   const [showDevPanel, setShowDevPanel] = useState(false);
   const [heartDelta, setHeartDelta] = useState(1);
@@ -296,16 +280,7 @@ const GameScreen = ({ onShowHearts }: { onShowHearts: () => void }) => {
     const reverse = text.split('').reverse().join('');
     const matched = words.find((word) => !word.found && (word.word === text || word.word === reverse));
     if (!matched) return;
-    vibrate(); // plays 'tap'
-
-    // Check if this was the last word needed to win
-    const remainingWords = words.filter((w) => !w.found).length;
-    if (remainingWords === 1) {
-      playSfx('win');
-    } else {
-      playSfx('found');
-    }
-
+    vibrate();
     setWords((prev) => prev.map((word) => (word.word === matched.word ? { ...word, found: true } : word)));
     setGrid((prev) => prev.map((cell) => (ids.includes(cell.id) ? { ...cell, found: true } : cell)));
   };
@@ -395,7 +370,7 @@ const GameScreen = ({ onShowHearts }: { onShowHearts: () => void }) => {
   if (won) return <ResultScreen elapsed={elapsed} onShowHearts={onShowHearts} grid={grid} words={words} />;
 
   return (
-    <div className="flex-1 p-4" onPointerUp={handlePointerUp} onPointerLeave={handlePointerUp} onPointerCancel={handlePointerUp}>
+    <div className="flex-1 p-4" onPointerUp={handlePointerUp}>
       <div className="flex items-center justify-between mb-4">
         <div className="bg-[#FF0080]/20 border border-[#FF0080] rounded-full px-3 py-1 text-[#FF0080] font-mono font-bold">{formatTime(elapsed)}</div>
         <div className="flex items-center gap-2">
@@ -426,7 +401,7 @@ const GameScreen = ({ onShowHearts }: { onShowHearts: () => void }) => {
 
       <div
         className="grid grid-cols-10 gap-1 bg-black/40 p-2 rounded-xl border border-white/10 select-none touch-none"
-        style={{ touchAction: 'none', WebkitUserSelect: 'none' }}
+        style={{ touchAction: 'none' }}
         onPointerMove={handlePointerMove}
       >
         {grid.map((cell) => {
@@ -460,38 +435,29 @@ const GameScreen = ({ onShowHearts }: { onShowHearts: () => void }) => {
 // ê²Œì„ í´ë¦¬ì–´ í›„ í‘œì‹œë˜ëŠ” í™”ë©´ìœ¼ë¡œ, ì†Œìš” ì‹œê°„ê³¼ í˜„ì¬ ë¦¬ê·¸ì—ì„œì˜ ì˜ˆìƒ ë“±ìˆ˜,
 // ê·¸ë¦¬ê³  ì™„ì„±ëœ ì›Œë“œì„œì¹˜ ê·¸ë¦¬ë“œ ë° ì¹œêµ¬ ì´ˆëŒ€(ê³µìœ ) ë§í¬ í‘œì‹œ ê¸°ëŠ¥ì„ í•©ë‹ˆë‹¤.
 const ResultScreen = ({ elapsed, onShowHearts, grid, words }: { elapsed: number; onShowHearts: () => void; grid: GridCell[]; words: WordConfig[]; }) => {
-  const { setView, leaderboard, currentUser, language, getReferralLink, consumeHeart, login } = useStore();
+  const { setView, leaderboard, currentUser, language, getReferralLink, consumeHeart } = useStore();
   const canvasRef = useRef<HTMLCanvasElement>(null);
   const [cardGenerated, setCardGenerated] = useState(false);
   const [copied, setCopied] = useState(false);
 
-  const myEntry = leaderboard.find((e) => e.isCurrentUser);
-  // Real rank calculation
-  const rank = myEntry?.rank ?? (leaderboard.filter(e => e.time < elapsed).length + 1);
-  const percentile = leaderboard.length > 0 ? Math.ceil((rank / leaderboard.length) * 100) : 1;
-  const titleText = percentile <= 10 ? 'TOP 1% ARMY' : `Rank #${rank}`;
+  const visibleLeaderboard = leaderboard.filter((entry) => !entry.banned);
+  const myEntry = visibleLeaderboard.find((e) => e.isCurrentUser);
+  const rank = myEntry?.rank ?? (visibleLeaderboard.filter((e) => e.time < elapsed).length + 1);
+  const percentile = visibleLeaderboard.length > 0 ? Math.ceil((rank / visibleLeaderboard.length) * 100) : 1;
+  const titleText = percentile <= 1 ? 'TOP 1% ARMY' : percentile <= 10 ? 'TOP 10% ARMY' : `Rank #${rank}`;
 
   useEffect(() => {
     // Check if this was a new best time
-    const playHistory = currentUser?.gameHistory?.filter(h => h.type === 'PLAY') || [];
-    const isNewBest = playHistory.length === 1 || Math.min(...playHistory.map(h => h.value)) === elapsed;
+    const playHistory = currentUser?.gameHistory?.filter((h) => h.type === 'PLAY') || [];
+    const historicalBest = playHistory.length > 1 ? Math.min(...playHistory.slice(0, -1).map((h) => h.value)) : Infinity;
+    const isNewBest = playHistory.length === 1 || elapsed < historicalBest;
 
     if (isNewBest) {
       confetti({
         particleCount: 150,
         spread: 80,
         origin: { y: 0.4 },
-        colors: ['#00FFFF', '#FF0080', '#FFD700', '#FFFFFF'],
-        zIndex: 50
-      });
-      playSfx('win');
-    } else {
-      confetti({
-        particleCount: 40,
-        spread: 40,
-        origin: { y: 0.6 },
-        colors: ['#FFFFFF', '#FF0080'],
-        zIndex: 50
+        colors: ['#00FFFF', '#FF0080', '#FFD700', '#FFFFFF']
       });
     }
   }, [elapsed, currentUser?.gameHistory]);
@@ -612,17 +578,27 @@ const ResultScreen = ({ elapsed, onShowHearts, grid, words }: { elapsed: number;
         }
       }
       // Fallback: copy link
-      await navigator.clipboard.writeText(`${titleText} - ${formatTime(elapsed)} | ${getReferralLink()}`);
-      setCopied(true);
-      setTimeout(() => setCopied(false), 2000);
-    } catch (e: any) {
-      if (e.name !== 'AbortError') {
-        alert('Failed to share: ' + e.message);
+      if (navigator.clipboard?.writeText) {
+        await navigator.clipboard.writeText(`${titleText} - ${formatTime(elapsed)} | ${getReferralLink()}`);
+        setCopied(true);
+        setTimeout(() => setCopied(false), 2000);
+      } else {
+        window.prompt('Copy this result link:', `${titleText} - ${formatTime(elapsed)} | ${getReferralLink()}`);
+      }
+    } catch (e: unknown) {
+      const errorName = e instanceof Error ? e.name : '';
+      const errorMessage = e instanceof Error ? e.message : String(e);
+      if (errorName !== 'AbortError') {
+        alert('Failed to share: ' + errorMessage);
         try {
-          await navigator.clipboard.writeText(`${titleText} - ${formatTime(elapsed)} | ${getReferralLink()}`);
-          setCopied(true);
-          setTimeout(() => setCopied(false), 2000);
-        } catch (err) { }
+          if (navigator.clipboard?.writeText) {
+            await navigator.clipboard.writeText(`${titleText} - ${formatTime(elapsed)} | ${getReferralLink()}`);
+            setCopied(true);
+            setTimeout(() => setCopied(false), 2000);
+          } else {
+            window.prompt('Copy this result link:', `${titleText} - ${formatTime(elapsed)} | ${getReferralLink()}`);
+          }
+        } catch { }
       }
     }
   };
@@ -630,9 +606,13 @@ const ResultScreen = ({ elapsed, onShowHearts, grid, words }: { elapsed: number;
   const handleCopyLink = async () => {
     vibrate();
     try {
-      await navigator.clipboard.writeText(getReferralLink());
-      setCopied(true);
-      setTimeout(() => setCopied(false), 2000);
+      if (navigator.clipboard?.writeText) {
+        await navigator.clipboard.writeText(getReferralLink());
+        setCopied(true);
+        setTimeout(() => setCopied(false), 2000);
+      } else {
+        window.prompt('Copy this invite link:', getReferralLink());
+      }
     } catch {
       // no-op
     }
@@ -656,16 +636,6 @@ const ResultScreen = ({ elapsed, onShowHearts, grid, words }: { elapsed: number;
         </button>
       </div>
 
-      {(!currentUser && elapsed < 120000) && (
-        <div className="w-full max-w-[280px] bg-gradient-to-r from-[#00FFFF]/10 to-[#FF0080]/10 border border-[#00FFFF]/30 p-4 rounded-xl mt-4 animate-pulse">
-          <p className="text-white font-bold mb-2">ğŸ”¥ Amazing Time!</p>
-          <p className="text-white/80 text-xs mb-3">Save your score to the global leaderboard and win genuine prizes!</p>
-          <button onClick={() => { vibrate(); login().then(() => setView('HOME')); }} className="w-full bg-[#00FFFF] text-black font-bold py-2 rounded-lg btn-squishy">
-            Save My Score
-          </button>
-        </div>
-      )}
-
       <button onClick={() => { vibrate(); const ok = consumeHeart(); if (ok) { setView('GAME'); } else { onShowHearts(); setView('HOME'); } }} className="mt-3 text-white/80 underline btn-squishy">{t(language, 'retryGame')}</button>
 
       {rank > 1 && (
@@ -902,21 +872,17 @@ const LeaderboardScreen = ({ onShowHearts }: { onShowHearts: () => void }) => {
       )}
 
       <div className="flex-1 overflow-y-auto p-4 space-y-2">
-        {leaderboard.filter((entry) => !entry.banned).length === 0 ? (
-          <div className="py-10 text-center text-white/40 text-sm">{t(language, 'noRecordYet')}</div>
-        ) : (
-          leaderboard.filter((entry) => !entry.banned).slice(0, 100).map((entry, index) => (
-            <div key={entry.id} className={`flex items-center p-3 rounded-lg border transition-all ${entry.isCurrentUser ? 'bg-[#FF0080]/20 border-[#FF0080] shadow-[0_0_15px_rgba(255,0,128,0.3)]' : 'bg-white/5 border-transparent hover:bg-white/8'}`}>
-              <div className="w-8 text-lg text-center font-bold">{index < 3 ? ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'][index] : <span className="text-white/50 text-sm">{entry.rank}</span>}</div>
-              <img src={entry.avatarUrl} alt={entry.nickname} width="40" height="40" className="w-8 h-8 rounded-full mr-2 border border-white/20" />
-              <div className="mr-2 text-xl" title={entry.country}>{getCountryFlag(entry.country)}</div>
-              <div className="flex-1 min-w-0">
-                <p className={`font-semibold text-sm truncate ${entry.isCurrentUser ? 'text-[#FF0080]' : 'text-white'}`}>{entry.nickname}</p>
-              </div>
-              <p className="font-mono text-[#00FFFF] text-sm">{formatTime(entry.time)}</p>
+        {leaderboard.filter((entry) => !entry.banned).map((entry, index) => (
+          <div key={entry.id} className={`flex items-center p-3 rounded-lg border transition-all ${entry.isCurrentUser ? 'bg-[#FF0080]/20 border-[#FF0080] shadow-[0_0_15px_rgba(255,0,128,0.3)]' : 'bg-white/5 border-transparent hover:bg-white/8'}`}>
+            <div className="w-8 text-lg text-center font-bold">{index < 3 ? ['ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰'][index] : <span className="text-white/50 text-sm">{entry.rank}</span>}</div>
+            <img src={entry.avatarUrl} alt={entry.nickname} className="w-8 h-8 rounded-full mr-2 border border-white/20" />
+            <div className="mr-2 text-xl" title={entry.country}>{getCountryFlag(entry.country)}</div>
+            <div className="flex-1 min-w-0">
+              <p className={`font-semibold text-sm truncate ${entry.isCurrentUser ? 'text-[#FF0080]' : 'text-white'}`}>{entry.nickname}</p>
             </div>
-          ))
-        )}
+            <p className="font-mono text-[#00FFFF] text-sm">{formatTime(entry.time)}</p>
+          </div>
+        ))}
       </div>
 
       {currentUser && myEntry && (
@@ -949,11 +915,8 @@ const AdminScreen = () => {
   const [noticeDraft, setNoticeDraft] = useState(notice);
   const [heartDraft, setHeartDraft] = useState(3);
   const [selectedUserId, setSelectedUserId] = useState<string | null>(null);
-  const [adminSearchQuery, setAdminSearchQuery] = useState('');
   const [adminSortBy, setAdminSortBy] = useState<'TIME' | 'HEARTS' | 'NEWEST'>('NEWEST');
 
-  if (currentUser?.role !== 'ADMIN') return <div className="flex-1 p-4 flex items-center justify-center text-white/50">Unauthorized Access</div>;
-
   const [botMean, setBotMean] = useState(botConfig.mean / 1000);
   const [botStd, setBotStd] = useState(botConfig.stdDev / 1000);
 
@@ -1006,7 +969,7 @@ const AdminScreen = () => {
           <p className="text-[#00FFFF] font-semibold mb-2 text-sm flex items-center gap-1">ğŸ¤– ë´‡ ì„¤ì • (Bot Settings)</p>
           <div className="flex items-center gap-2 mb-2">
             <label className="text-white/70 text-xs w-20">í‰ê·  ì‹œê°„(ì´ˆ)</label>
-            <input type="number" min="10" max="180" step="1" value={botMean} onChange={e => setBotMean(Number(e.target.value))} className="flex-1 bg-black/30 border border-white/20 text-white rounded px-2 py-1 text-sm outline-none focus:border-[#00FFFF]" />
+            <input type="number" min="5" max="300" step="1" value={botMean} onChange={e => setBotMean(Number(e.target.value))} className="flex-1 bg-black/30 border border-white/20 text-white rounded px-2 py-1 text-sm outline-none focus:border-[#00FFFF]" />
           </div>
           <div className="flex items-center gap-2 mb-2">
             <label className="text-white/70 text-xs w-20">í‘œì¤€í¸ì°¨(ì´ˆ)</label>
@@ -1035,61 +998,58 @@ const AdminScreen = () => {
       <div className="bg-[#1A0B2E] rounded-xl p-4 border border-white/10 space-y-2">
         <div className="flex items-center justify-between mb-2">
           <p className="text-white font-semibold">{t(language, 'userManagement')} (Total: {adminUsers.length})</p>
-          <div className="flex gap-2">
-            <input
-              type="text"
-              placeholder="Search..."
-              value={adminSearchQuery}
-              onChange={e => setAdminSearchQuery(e.target.value)}
-              className="w-24 bg-black/30 border border-white/20 text-white/70 text-xs rounded px-2 outline-none"
-            />
-            <select value={adminSortBy} onChange={(e) => setAdminSortBy(e.target.value as 'TIME' | 'HEARTS' | 'NEWEST')} className="bg-black/30 border border-white/20 text-white/70 text-xs rounded p-1 outline-none">
-              <option value="NEWEST">ìµœì‹ ìˆœ (Newest)</option>
-              <option value="TIME">ìµœê³ ê¸°ë¡ìˆœ (Best Time)</option>
-              <option value="HEARTS">í•˜íŠ¸ë³´ìœ ìˆœ (Most Hearts)</option>
-            </select>
-          </div>
+          <select value={adminSortBy} onChange={(e) => setAdminSortBy(e.target.value as 'TIME' | 'HEARTS' | 'NEWEST')} className="bg-black/30 border border-white/20 text-white/70 text-xs rounded p-1 outline-none">
+            <option value="NEWEST">ìµœì‹ ìˆœ (Newest)</option>
+            <option value="TIME">ìµœê³ ê¸°ë¡ìˆœ (Best Time)</option>
+            <option value="HEARTS">í•˜íŠ¸ë³´ìœ ìˆœ (Most Hearts)</option>
+          </select>
         </div>
 
         {(() => {
-          const sortedUsers = [...(adminUsers.length > 0 ? adminUsers : leaderboard)].filter(u => {
-            if (u.banned) return false;
-            // Fuzzy search
-            if (adminSearchQuery) {
-              const q = adminSearchQuery.toLowerCase();
-              const nn = (u.nickname || '').toLowerCase();
-              const id = (u.id || '').toLowerCase();
-              if (!nn.includes(q) && !id.includes(q)) return false;
+          type AdminListEntry = {
+            id: string;
+            banned?: boolean;
+            time?: number;
+            hearts?: number;
+            updatedAt?: { toMillis?: () => number } | string | number | Date;
+            gameHistory?: HistoryEvent[];
+            avatarUrl?: string;
+            nickname?: string;
+            country?: string;
+            role?: 'USER' | 'ADMIN';
+            email?: string;
+            referralCode?: string;
+            referredBy?: string;
+          };
+          const sourceUsers = (adminUsers.length > 0 ? adminUsers : leaderboard) as AdminListEntry[];
+          const getUpdatedAtMs = (value: AdminListEntry['updatedAt']) => {
+            if (!value) return 0;
+            if (typeof value === 'object' && value !== null && 'toMillis' in value && typeof value.toMillis === 'function') {
+              return value.toMillis();
             }
-            return true;
-          }).sort((a: any, b: any) => {
-            if (adminSortBy === 'TIME') return (a.time || Infinity) - (b.time || Infinity);
-            if (adminSortBy === 'HEARTS') return (b.hearts || 0) - (a.hearts || 0);
-            const timeA = a.updatedAt ? (typeof a.updatedAt.toMillis === 'function' ? a.updatedAt.toMillis() : new Date(a.updatedAt).getTime()) : 0;
-            const timeB = b.updatedAt ? (typeof b.updatedAt.toMillis === 'function' ? b.updatedAt.toMillis() : new Date(b.updatedAt).getTime()) : 0;
+            return new Date(value as string | number | Date).getTime();
+          };
+          const sortedUsers = [...sourceUsers].filter((u) => !u.banned).sort((a, b) => {
+            if (adminSortBy === 'TIME') return (a.time ?? Infinity) - (b.time ?? Infinity);
+            if (adminSortBy === 'HEARTS') return (b.hearts ?? 0) - (a.hearts ?? 0);
+            const timeA = getUpdatedAtMs(a.updatedAt);
+            const timeB = getUpdatedAtMs(b.updatedAt);
             return timeB - timeA;
           });
 
-          if (sortedUsers.length === 0) {
-            return (
-              <div className="flex flex-col items-center justify-center py-8 text-white/40">
-                <p className="text-sm">No users found</p>
-              </div>
-            );
-          }
-
-          return sortedUsers.slice(0, 20).map((u) => {
-            const entry = u as any;
+          return sortedUsers.slice(0, 20).map((entry) => {
             const isSelected = selectedUserId === entry.id;
-            const lastLogin = entry.updatedAt ? new Date(typeof entry.updatedAt.toMillis === 'function' ? entry.updatedAt.toMillis() : entry.updatedAt).toLocaleString() : 'Unknown';
-            const playHistoryCount = entry.gameHistory?.filter((h: any) => h.type === 'PLAY').length || 0;
-            const adRevenueApprox = (entry.gameHistory?.filter((h: any) => h.type === 'AD').reduce((acc: number, val: any) => acc + (val.value > 0 ? 0.35 : 0), 0) || 0).toFixed(2);
+            const lastLoginMs = getUpdatedAtMs(entry.updatedAt);
+            const lastLogin = lastLoginMs > 0 ? new Date(lastLoginMs).toLocaleString() : 'Unknown';
+            const history = Array.isArray(entry.gameHistory) ? entry.gameHistory : [];
+            const playHistoryCount = history.filter((h) => h.type === 'PLAY').length;
+            const adRevenueApprox = history.filter((h) => h.type === 'AD').reduce((acc, val) => acc + (val.value > 0 ? 0.35 : 0), 0).toFixed(2);
 
             return (
               <div key={entry.id} className={`flex flex-col bg-black/20 p-2 rounded transition-all ${isSelected ? 'ring-1 ring-[#00FFFF]' : ''}`}>
                 <div className="flex items-center justify-between cursor-pointer" onClick={() => setSelectedUserId(isSelected ? null : entry.id)}>
                   <div className="flex items-center gap-2 flex-1 min-w-0">
-                    <img src={entry.avatarUrl || `https://picsum.photos/seed/${entry.id}/80/80`} width="40" height="40" className="w-8 h-8 rounded-full flex-shrink-0 border border-white/10" />
+                    <img src={entry.avatarUrl || `https://picsum.photos/seed/${entry.id}/80/80`} className="w-8 h-8 rounded-full flex-shrink-0 border border-white/10" />
                     <div className="min-w-0">
                       <p className="text-white text-sm truncate font-bold">{entry.nickname || 'Unknown User'}</p>
                       <div className="flex items-center gap-2 text-white/50 text-[10px]">
@@ -1102,7 +1062,7 @@ const AdminScreen = () => {
                   </div>
                   <div className="flex items-center gap-1 flex-shrink-0">
                     {currentUser?.id !== entry.id && (
-                      <button onClick={(e) => { e.stopPropagation(); vibrate(); banUser(entry.id); }} className="bg-red-500/20 text-red-500 border border-red-500/50 text-xs px-2 py-1 rounded btn-squishy">ğŸš« Ban</button>
+                      <button onClick={(e) => { e.stopPropagation(); vibrate(); banUser(entry.id); }} className="bg-red-500/20 text-red-500 border border-red-500/50 text-xs px-2 py-1 rounded btn-squishy">BAN</button>
                     )}
                   </div>
                 </div>
@@ -1324,12 +1284,12 @@ const HeartsModal = ({ isOpen, onClose }: { isOpen: boolean; onClose: () => void
     try {
       if (navigator.share) {
         await navigator.share({ title: 'StanBeat', text: 'Can you beat my record? Play StanBeat!', url: link });
-      } else if (navigator.clipboard) {
+      } else if (navigator.clipboard?.writeText) {
         await navigator.clipboard.writeText(link);
         setLinkCopied(true);
         setTimeout(() => setLinkCopied(false), 2000);
       } else {
-        alert('Link copied: ' + link);
+        window.prompt('Copy this invite link:', link);
       }
     } catch { }
   };
@@ -1342,7 +1302,6 @@ const HeartsModal = ({ isOpen, onClose }: { isOpen: boolean; onClose: () => void
             src={iframeUrl}
             className="w-full h-full border-none"
             title="Adscend Media"
-            sandbox="allow-scripts allow-same-origin allow-popups"
             allow="autoplay"
           />
         </div>
@@ -1400,57 +1359,33 @@ const HeartsModal = ({ isOpen, onClose }: { isOpen: boolean; onClose: () => void
   );
 };
 
-// â”€â”€â”€ Offline Toast â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
-const OfflineToast = () => {
-  const [isOffline, setIsOffline] = useState(!navigator.onLine);
-  useEffect(() => {
-    const handleOnline = () => setIsOffline(false);
-    const handleOffline = () => setIsOffline(true);
-    window.addEventListener('online', handleOnline);
-    window.addEventListener('offline', handleOffline);
-    return () => {
-      window.removeEventListener('online', handleOnline);
-      window.removeEventListener('offline', handleOffline);
-    };
-  }, []);
-
-  if (!isOffline) return null;
-
-  return (
-    <div className="fixed top-safe z-[3000] w-full flex justify-center py-2 animate-slide-down pointer-events-none">
-      <div className="bg-red-500 text-white px-4 py-2 rounded-full font-bold shadow-[0_0_15px_rgba(239,68,68,0.5)] flex items-center gap-2 text-sm border-2 border-red-400">
-        <span>âš ï¸ No Internet Connection</span>
-      </div>
-    </div>
-  );
-};
-
 // â”€â”€â”€ ë©”ì¸ ì•± ì»¨í…Œì´ë„ˆ ì»´í¬ë„ŒíŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 // ì „ì²´ ì•±ì˜ ìƒíƒœ(ë¼ìš°íŒ…/ë·°)ë¥¼ ê´€ë¦¬í•˜ê³ , ì–¸ì–´ ìë™ ê°ì§€,
 // í•˜íŠ¸ ì¶©ì „ ëª¨ë‹¬, ëª¨ë°”ì¼ ë ˆì´ì•„ì›ƒ(í•˜ë‹¨ ì •ë³´) ë“±ì„ í†µí•© ë Œë”ë§í•©ë‹ˆë‹¤.
 export default function App() {
-  const { currentView, language, currentUser, initAdscendListener, setLanguage, showBrowserBlocker, setShowBrowserBlocker } = useStore();
+  const { currentView, language, currentUser, initAdscendListener, setLanguage } = useStore();
   const [showLanguageModal, setShowLanguageModal] = useState(false);
   const [showHeartsModal, setShowHeartsModal] = useState(false);
 
-  // Global BeforeInstallPrompt listener
-  useEffect(() => {
-    const handler = (e: any) => {
-      e.preventDefault();
-      useStore.setState({ deferredPrompt: e });
-    };
-    window.addEventListener('beforeinstallprompt', handler);
-    return () => window.removeEventListener('beforeinstallprompt', handler);
-  }, []);
-
   // IP ê¸°ë°˜ ì–¸ì–´ ìë™ ê°ì§€
   useEffect(() => {
-    const saved = localStorage.getItem('stanbeat_lang');
+    let cancelled = false;
+    let saved: string | null = null;
+    try {
+      saved = localStorage.getItem('stanbeat_lang');
+    } catch {
+      saved = null;
+    }
+
     if (!saved) {
       detectLanguageFromIP().then((lang) => {
-        if (lang) setLanguage(lang);
+        if (!cancelled && lang) setLanguage(lang);
       });
     }
+
+    return () => {
+      cancelled = true;
+    };
   }, [setLanguage]);
 
   // Initialize ad rewards listener when logged in
@@ -1460,23 +1395,8 @@ export default function App() {
     }
   }, [currentUser, initAdscendListener]);
 
-  // Handle browser back button (popstate mapping to SetView)
-  useEffect(() => {
-    const handlePopState = (e: PopStateEvent) => {
-      const state = e.state as { view?: any };
-      if (state && state.view) {
-        useStore.setState({ currentView: state.view });
-      } else {
-        useStore.setState({ currentView: 'HOME' });
-      }
-    };
-    window.addEventListener('popstate', handlePopState);
-    return () => window.removeEventListener('popstate', handlePopState);
-  }, []);
-
   return (
     <Layout onOpenLanguage={() => setShowLanguageModal(true)} onOpenHearts={() => setShowHeartsModal(true)}>
-      <OfflineToast />
       {currentView === 'HOME' && <HomeScreen onShowHearts={() => setShowHeartsModal(true)} />}
       {currentView === 'GAME' && <GameScreen onShowHearts={() => setShowHeartsModal(true)} />}
       {currentView === 'LEADERBOARD' && <LeaderboardScreen onShowHearts={() => setShowHeartsModal(true)} />}
@@ -1486,14 +1406,6 @@ export default function App() {
       <LanguageModal isOpen={showLanguageModal} onClose={() => setShowLanguageModal(false)} />
       <HeartsModal isOpen={showHeartsModal} onClose={() => setShowHeartsModal(false)} />
 
-      {/* In-App Browser Blocker Modal */}
-      <Modal isOpen={showBrowserBlocker} onClose={() => setShowBrowserBlocker(false)} title="Browser Not Supported">
-        <p className="text-white/80 text-sm mb-4 text-center">Google Login is blocked in in-app browsers (Instagram, Facebook, etc). Please copy the link and open it in Safari or Chrome.</p>
-        <button onClick={() => { vibrate(); navigator.clipboard.writeText('https://stanbeat.web.app').then(() => alert('Link copied! Paste in Chrome/Safari.')); }} className="w-full bg-[#00FFFF] text-black font-bold py-3 rounded-lg btn-squishy text-lg">
-          Copy Link URL
-        </button>
-      </Modal>
-
       {(currentView === 'HOME' || currentView === 'LEADERBOARD') && (
         <footer className="bg-[#050208] p-4 text-center border-t border-white/10">
           <p className="text-[10px] text-[#4d4d4d] leading-tight">{t(language, 'legal')}</p>
diff --git a/adscend.ts b/adscend.ts
index 3f2abee..c16d15b 100644
--- a/adscend.ts
+++ b/adscend.ts
@@ -76,14 +76,10 @@ export function listenForRewards(userId: string, onReward: (reward: unknown) =>
 // claimedAt = ì„œë²„ íƒ€ì„ìŠ¤íƒ¬í”„ â†’ ì´ ê°’ì´ ìˆìœ¼ë©´ listenForRewards ì¿¼ë¦¬ì— ê±¸ë¦¬ì§€ ì•ŠìŒ
 export async function claimRewardInFirestore(rewardId: string): Promise<void> {
     if (!db) return; // Firestore ë¯¸ì„¤ì •ì´ë©´ ë¬´ì‹œ
-    try {
-        const rewardRef = doc(db, 'adRewards', rewardId); // ë³´ìƒ ë¬¸ì„œ ì°¸ì¡°
+    const rewardRef = doc(db, 'adRewards', rewardId); // ë³´ìƒ ë¬¸ì„œ ì°¸ì¡°
 
-        // claimedAt í•„ë“œë¥¼ ì„œë²„ íƒ€ì„ìŠ¤íƒ¬í”„ë¡œ ì—…ë°ì´íŠ¸ (ì²­êµ¬ ì™„ë£Œ ê¸°ë¡)
-        await updateDoc(rewardRef, {
-            claimedAt: serverTimestamp(), // í´ë¼ì´ì–¸íŠ¸ ì‹œê°„ ëŒ€ì‹  ì„œë²„ ì‹œê°„ ì‚¬ìš© (ì¡°ì‘ ë°©ì§€)
-        });
-    } catch (error) {
-        console.error('[Adscend] Failed to claim reward:', error);
-    }
+    // claimedAt í•„ë“œë¥¼ ì„œë²„ íƒ€ì„ìŠ¤íƒ¬í”„ë¡œ ì—…ë°ì´íŠ¸ (ì²­êµ¬ ì™„ë£Œ ê¸°ë¡)
+    await updateDoc(rewardRef, {
+        claimedAt: serverTimestamp(), // í´ë¼ì´ì–¸íŠ¸ ì‹œê°„ ëŒ€ì‹  ì„œë²„ ì‹œê°„ ì‚¬ìš© (ì¡°ì‘ ë°©ì§€)
+    });
 }
diff --git a/components/ErrorBoundary.tsx b/components/ErrorBoundary.tsx
index 7a808e5..4b8eb74 100644
--- a/components/ErrorBoundary.tsx
+++ b/components/ErrorBoundary.tsx
@@ -1,5 +1,5 @@
-import React from 'react';
-import type { ReactNode, ErrorInfo } from 'react';
+// @ts-nocheck
+import { Component, type ErrorInfo, type ReactNode } from 'react';
 
 interface ErrorBoundaryProps {
     children: ReactNode;
@@ -15,7 +15,7 @@ interface ErrorBoundaryState {
  * Global React Error Boundary. (ê¸€ë¡œë²Œ ë¦¬ì•¡íŠ¸ ì—ëŸ¬ ê²½ê³„ ì»´í¬ë„ŒíŠ¸)
  * ì•± ì „ì²´ì—ì„œ ë°œìƒí•˜ëŠ” ë Œë”ë§ ì—ëŸ¬ë¥¼ í¬ì°©í•˜ì—¬ ë¹ˆ í™”ë©´ ëŒ€ì‹  ë³µêµ¬ UIë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.
  */
-class ErrorBoundaryClass extends React.Component<ErrorBoundaryProps, ErrorBoundaryState> {
+class ErrorBoundaryClass extends Component<ErrorBoundaryProps, ErrorBoundaryState> {
     constructor(props: ErrorBoundaryProps) {
         super(props);
         this.state = {
@@ -47,7 +47,8 @@ class ErrorBoundaryClass extends React.Component<ErrorBoundaryProps, ErrorBounda
     // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ ì „ì²´ ì´ˆê¸°í™” í›„ ìƒˆë¡œê³ ì¹¨ (ì¹˜ëª…ì  ì—ëŸ¬ í•´ê²°ìš©)
     handleReset(): void {
         try {
-            localStorage.clear();
+            const stanbeatKeys = Object.keys(localStorage).filter((key) => key.startsWith('stanbeat_'));
+            stanbeatKeys.forEach((key) => localStorage.removeItem(key));
         } catch {
             // localStorage ì ‘ê·¼ ë¶ˆê°€ ì‹œ ë¬´ì‹œ
         }
@@ -108,7 +109,7 @@ class ErrorBoundaryClass extends React.Component<ErrorBoundaryProps, ErrorBounda
                             }}
                         >
                             {this.state.error.toString()}
-                            {this.state.errorInfo?.componentStack}
+                            {import.meta.env.DEV ? this.state.errorInfo?.componentStack : null}
                         </pre>
                     )}
 
diff --git a/components/Layout.tsx b/components/Layout.tsx
index 99d0d81..3763c5f 100644
--- a/components/Layout.tsx
+++ b/components/Layout.tsx
@@ -84,7 +84,7 @@ export const Header = () => {
 
   return (
     <header className="sticky top-0 z-50 bg-[#1A0B2E]/90 backdrop-blur-md border-b border-[#FF0080]/30 px-4 py-3 flex justify-between items-center shadow-[0_4px_20px_rgba(255,0,128,0.2)]">
-      <button onClick={() => { vibrate(); toggleMenu(); }} className="text-[#00FFFF] btn-squishy neon-glow-icon" aria-label="Open Menu">
+      <button onClick={() => { vibrate(); toggleMenu(); }} className="text-[#00FFFF] btn-squishy neon-glow-icon">
         <Menu size={24} />
       </button>
       {/* 5ì´ˆ(í˜„ì¬ 3ì´ˆ) ë¡±í”„ë ˆìŠ¤ ì‹œ ê´€ë¦¬ì ëª¨ë“œ(ADMIN) í† ê¸€ í™œì„±í™” */}
@@ -113,8 +113,6 @@ export const Header = () => {
 // â”€â”€â”€ ì‚¬ì´ë“œ ë©”ë‰´ ì»´í¬ë„ŒíŠ¸ (ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ, í™ˆ, ë¦¬ë”ë³´ë“œ, íˆìŠ¤í† ë¦¬ ë“±) â”€â”€â”€
 export const SideMenu = ({ onOpenLanguage, onOpenHearts }: { onOpenLanguage: () => void; onOpenHearts: () => void }) => {
   const { isMenuOpen, toggleMenu, currentUser, logout, login, setView, language, consumeHeart } = useStore();
-  const [isLoggingIn, setIsLoggingIn] = useState(false);
-
   if (!isMenuOpen) return null;
 
   return (
@@ -124,7 +122,7 @@ export const SideMenu = ({ onOpenLanguage, onOpenHearts }: { onOpenLanguage: ()
         <div className="p-6 border-b border-white/10 bg-gradient-to-br from-[#FF0080]/20 to-transparent">
           <div className="flex items-center justify-between mb-4">
             <h2 className="text-[#00FFFF] font-display text-xl neon-cyan">{t(language, 'profile')}</h2>
-            <button onClick={toggleMenu} className="btn-squishy" aria-label="Close Menu"><X className="text-white/70" /></button>
+            <button onClick={toggleMenu} className="btn-squishy"><X className="text-white/70" /></button>
           </div>
           {currentUser ? (
             <div className="flex items-center gap-3">
@@ -136,21 +134,9 @@ export const SideMenu = ({ onOpenLanguage, onOpenHearts }: { onOpenLanguage: ()
             </div>
           ) : (
             <button
-              disabled={isLoggingIn}
-              onClick={async () => {
-                if (isLoggingIn) return;
-                setIsLoggingIn(true);
-                vibrate();
-                try {
-                  await login();
-                  toggleMenu();
-                } finally {
-                  setIsLoggingIn(false);
-                }
-              }}
-              className="w-full bg-[#FF0080] text-white py-2 rounded font-bold btn-squishy disabled:opacity-50 flex items-center justify-center gap-2"
+              onClick={() => { vibrate(); login(); toggleMenu(); }}
+              className="w-full bg-[#FF0080] text-white py-2 rounded font-bold btn-squishy"
             >
-              {isLoggingIn ? <span className="animate-spin text-xl">â†»</span> : null}
               {t(language, 'loginWithGoogle')}
             </button>
           )}
@@ -194,7 +180,7 @@ const MenuItem = ({ icon, label, color = 'text-white', onClick }: { icon: React.
 
 export const Layout = ({ children, onOpenLanguage, onOpenHearts }: { children?: React.ReactNode; onOpenLanguage: () => void; onOpenHearts: () => void }) => (
   <div className="min-h-screen bg-[#1A0B2E] flex justify-center items-start relative overflow-hidden">
-    <div className="fixed inset-0 bg-gradient-to-br from-[#1A0B2E] via-[#0D0518] to-[#1A0B2E] animate-[bgShift_12s_ease-in-out_infinite_alternate] opacity-60" style={{ willChange: 'background-position' }} />
+    <div className="fixed inset-0 bg-gradient-to-br from-[#1A0B2E] via-[#0D0518] to-[#1A0B2E] animate-[bgShift_12s_ease-in-out_infinite_alternate] opacity-60" />
     <div className="fixed inset-0 bg-black/70 z-0" />
     <div className="w-full max-w-[430px] min-h-screen bg-[#0D0518]/85 relative z-10 shadow-2xl flex flex-col">
       <Header />
@@ -206,21 +192,12 @@ export const Layout = ({ children, onOpenLanguage, onOpenHearts }: { children?:
 );
 
 export const Modal = ({ isOpen, onClose, title, children }: { isOpen: boolean; onClose: () => void; title: string; children?: React.ReactNode }) => {
-  useEffect(() => {
-    if (isOpen) {
-      document.body.style.overflow = 'hidden';
-    } else {
-      document.body.style.overflow = '';
-    }
-    return () => { document.body.style.overflow = ''; };
-  }, [isOpen]);
-
   if (!isOpen) return null;
   return (
     <div className="fixed inset-0 z-[100] flex items-center justify-center p-4">
       <div className="absolute inset-0 bg-black/80 backdrop-blur-sm" onClick={onClose} />
-      <div className="bg-[#1A0B2E] w-full max-w-sm rounded-2xl border border-[#FF0080]/40 shadow-[0_0_30px_rgba(255,0,128,0.4)] relative p-6 max-h-[90vh] overflow-y-auto">
-        <button onClick={onClose} className="absolute top-4 right-4 text-white/50 hover:text-white btn-squishy" aria-label="Close Modal"><XCircle /></button>
+      <div className="bg-[#1A0B2E] w-full max-w-sm rounded-2xl border border-[#FF0080]/40 shadow-[0_0_30px_rgba(255,0,128,0.4)] relative p-6">
+        <button onClick={onClose} className="absolute top-4 right-4 text-white/50 hover:text-white btn-squishy"><XCircle /></button>
         <h3 className="text-2xl font-display text-white mb-4 text-center">{title}</h3>
         {children}
       </div>
diff --git a/firebase.ts b/firebase.ts
index 0a612c2..2fe5dbd 100644
--- a/firebase.ts
+++ b/firebase.ts
@@ -3,7 +3,7 @@
 // í™˜ê²½ë³€ìˆ˜(VITE_FIREBASE_*)ê°€ ì—†ëŠ” ê²½ìš° mock ëª¨ë“œë¡œ ë™ì‘í•˜ì—¬ ì˜¤ë¥˜ ì—†ì´ ì‹¤í–‰ë¨
 
 // Firebase App ì´ˆê¸°í™”ì— í•„ìš”í•œ í•¨ìˆ˜ ì„í¬íŠ¸
-import { initializeApp } from 'firebase/app';
+import { getApp, getApps, initializeApp } from 'firebase/app';
 
 // Firebase Auth ê´€ë ¨ ê¸°ëŠ¥ ì„í¬íŠ¸
 // - getAuth: Auth ì¸ìŠ¤í„´ìŠ¤ ê°€ì ¸ì˜¤ê¸°
@@ -44,7 +44,6 @@ import {
     getDocs,
     serverTimestamp,
     increment,
-    onSnapshot,
 } from 'firebase/firestore';
 
 // â”€â”€â”€ Firebase ì„¤ì • ê°ì²´ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
@@ -71,7 +70,7 @@ const isConfigured = !!(
 
 // â”€â”€â”€ Firebase ì¸ìŠ¤í„´ìŠ¤ ì´ˆê¸°í™” â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 // í™˜ê²½ë³€ìˆ˜ê°€ ìˆì„ ë•Œë§Œ ì‹¤ì œ Firebase ì•± ì´ˆê¸°í™” (ì—†ìœ¼ë©´ null)
-const app = isConfigured ? initializeApp(firebaseConfig) : null;
+const app = isConfigured ? (getApps().length ? getApp() : initializeApp(firebaseConfig)) : null;
 
 // Firebase Auth ì¸ìŠ¤í„´ìŠ¤ (ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒì— ì‚¬ìš©)
 const auth = isConfigured && app ? getAuth(app) : null;
@@ -226,20 +225,6 @@ export async function getGlobalStats(): Promise<Record<string, unknown> | null>
     }
 }
 
-// â”€â”€â”€ Firestore: ê¸€ë¡œë²Œ í†µê³„ ì‹¤ì‹œê°„ ì¡°íšŒ (Admin) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
-export function listenGlobalStats(callback: (stats: { totalHeartsUsed: number, adRevenue: number }) => void): () => void {
-    if (!db) return () => { };
-    const unsub = onSnapshot(doc(db, 'stats', 'global'), (snap) => {
-        if (snap.exists()) {
-            const data = snap.data();
-            callback({ totalHeartsUsed: Number(data.totalHeartsUsed || 0), adRevenue: Number(data.adRevenue || 0) });
-        }
-    }, (err) => {
-        console.error('[Firebase] Failed to listen to global stats:', err);
-    });
-    return unsub;
-}
-
 // â”€â”€â”€ Firestore: ì „ì²´ ì‚¬ìš©ì ëª©ë¡ ë°˜í™˜ (Admin) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 // ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œìš©, ëª¨ë“  users ì»¬ë ‰ì…˜ ë¬¸ì„œë¥¼ ë°˜í™˜ (í˜ì´ì§€ë„¤ì´ì…˜ ì—†ì´ ì „ë¶€ ë°˜í™˜ - DAU ì‚°ì •ìš©)
 export async function getAdminGlobalUsers(): Promise<Array<Record<string, unknown>>> {
diff --git a/i18n/index.ts b/i18n/index.ts
index 3b27bff..4eea8a6 100644
--- a/i18n/index.ts
+++ b/i18n/index.ts
@@ -71,8 +71,8 @@ const dictionaries: Record<LanguageCode, Messages> = {
 };
 
 export const t = (lang: LanguageCode, key: MessageKey, vars?: Record<string, string>) => {
-  const table = dictionaries[lang] ?? dictionaries.en ?? dictionaries.ko;
-  let value = table[key] ?? dictionaries.en[key] ?? baseMessages[key];
+  const table = dictionaries[lang] ?? dictionaries.ko;
+  let value = table[key] ?? baseMessages[key];
   if (vars) {
     Object.entries(vars).forEach(([k, v]) => {
       value = value.replaceAll(`{${k}}`, v);
diff --git a/store.ts b/store.ts
index 0a5d2aa..f118bc1 100644
--- a/store.ts
+++ b/store.ts
@@ -34,8 +34,6 @@ interface AppState {
   language: LanguageCode;
   notice: string;
   showNoticePopup: boolean;
-  showBrowserBlocker: boolean;
-  deferredPrompt: any | null;
   termsAccepted: boolean;
   seasonEndsAt: number;
   heartsUsedToday: number;
@@ -54,8 +52,6 @@ interface AppState {
   setLanguage: (lang: LanguageCode) => void;
   setNotice: (value: string) => void;
   setShowNoticePopup: (value: boolean) => void;
-  setShowBrowserBlocker: (value: boolean) => void;
-  setDeferredPrompt: (value: any | null) => void;
   acceptTerms: () => void;
 
   setBotConfig: (config: BotConfig) => void;
@@ -64,7 +60,7 @@ interface AppState {
   logout: () => void;
   consumeHeart: () => boolean;
   addHeart: (amount: number) => void;
-  claimDailyHeart: () => Promise<boolean>;
+  claimDailyHeart: () => boolean;
 
   updateBestTime: (time: number) => void;
   addHistoryEvent: (type: 'PLAY' | 'AD' | 'INVITE' | 'DAILY', value: number) => void;
@@ -96,6 +92,8 @@ const favorites = ['Jimin', 'V', 'Tiger', 'Jungkook', 'Hobi', 'ARMY', 'Kookie'];
 const countries = ['KR', 'US', 'JP', 'BR', 'TH', 'ID', 'PH', 'FR', 'DE', 'VN'];
 const AVATAR_SEED = 'stanbeat-avatar';
 const THREE_HOURS = 3 * 60 * 60 * 1000;
+const MAX_HEARTS = 3;
+const MAX_HISTORY_ITEMS = 100;
 
 const todayUtc = () => new Date().toISOString().slice(0, 10);
 
@@ -126,13 +124,13 @@ const safeStorage = {
 };
 
 export const detectLanguageFromIP = async (): Promise<LanguageCode | null> => {
-  if (safeStorage.get<boolean>('stanbeat_manual_lang', false)) {
-    return null; // Do not override if the user manually selected a language
-  }
+  const controller = new AbortController();
+  const timeoutId = setTimeout(() => controller.abort(), 3000);
   try {
-    const res = await fetch('https://ipapi.co/json/');
+    const res = await fetch('https://ipapi.co/json/', { signal: controller.signal });
+    if (!res.ok) return null;
     const data = await res.json();
-    const countryCode: string = data.country_code;
+    const countryCode = String(data.country_code ?? '').trim().toUpperCase();
     const map: Record<string, LanguageCode> = {
       KR: 'ko', JP: 'ja', CN: 'zh-CN', TH: 'th', ID: 'id',
       VN: 'vi', PH: 'en', US: 'en', GB: 'en', AU: 'en',
@@ -142,6 +140,8 @@ export const detectLanguageFromIP = async (): Promise<LanguageCode | null> => {
     return map[countryCode] ?? null;
   } catch {
     return null;
+  } finally {
+    clearTimeout(timeoutId);
   }
 };
 
@@ -153,9 +153,13 @@ const generateNickname = () => {
 };
 
 const generateReferralCode = () => {
-  const rand = Math.random().toString(36).substring(2, 8);
-  const time = Date.now().toString(36).slice(-4);
-  return (rand + time).toUpperCase();
+  if (typeof crypto !== 'undefined' && typeof crypto.getRandomValues === 'function') {
+    const bytes = new Uint8Array(6);
+    crypto.getRandomValues(bytes);
+    return Array.from(bytes, (b) => (b % 36).toString(36)).join('').slice(0, 8);
+  }
+  const randomPart = Math.random().toString(36).slice(2);
+  return randomPart.padEnd(8, 'x').slice(0, 8);
 };
 
 // ìœ ì € ê°ì²´ì˜ í•˜íŠ¸ ë§Œë£Œ ì‹œê°„ì„ ì²´í¬í•˜ì—¬, ë§Œë£Œë˜ì—ˆë‹¤ë©´ í•˜íŠ¸ë¥¼ 0ìœ¼ë¡œ ì´ˆê¸°í™”í•´ ë°˜í™˜í•˜ëŠ” ìƒíƒœ ì •ê·œí™” í•¨ìˆ˜
@@ -233,15 +237,13 @@ const savedAdConfig = safeStorage.get<AdConfig>('stanbeat_ad_config', DEFAULT_AD
 const savedBotConfig = safeStorage.get<BotConfig>('stanbeat_bot_config', { mean: 50000, stdDev: 15000 });
 
 export const useStore = create<AppState>((set, get) => ({
-  currentUser: savedUser ? normalizeHearts({ ...savedUser, gameHistory: Array.isArray(savedUser.gameHistory) ? savedUser.gameHistory.slice(-100) : [] }) : null,
+  currentUser: savedUser ? normalizeHearts(savedUser) : null,
   currentView: 'HOME',
   isMenuOpen: false,
   leaderboard: savedLeaderboard,
   language: savedLang,
   notice: savedNotice,
   showNoticePopup: savedShowNotice,
-  showBrowserBlocker: false,
-  deferredPrompt: null,
   termsAccepted: savedUser?.agreedToTerms ?? false,
   seasonEndsAt: safeStorage.get<number>('stanbeat_season_ends', Date.now() + getMsUntilNextUtcMidnight()),
   heartsUsedToday: safeStorage.get<number>('stanbeat_hearts_used', 0),
@@ -255,16 +257,10 @@ export const useStore = create<AppState>((set, get) => ({
   adminStats: { totalHeartsUsed: 0, adRevenue: 0 },
   botConfig: savedBotConfig,
 
-  setView: (view) => {
-    if (view !== get().currentView) {
-      window.history.pushState({ view }, '', window.location.pathname);
-      set({ currentView: view });
-    }
-  },
+  setView: (view) => set({ currentView: view }),
   toggleMenu: () => set((state) => ({ isMenuOpen: !state.isMenuOpen })),
   setLanguage: (language) => {
     safeStorage.set('stanbeat_lang', language);
-    safeStorage.set('stanbeat_manual_lang', true);
     if (language === 'ar') {
       document.documentElement.setAttribute('dir', 'rtl');
     } else {
@@ -280,8 +276,6 @@ export const useStore = create<AppState>((set, get) => ({
     safeStorage.set('stanbeat_show_notice', value);
     set({ showNoticePopup: value });
   },
-  setShowBrowserBlocker: (value) => set({ showBrowserBlocker: value }),
-  setDeferredPrompt: (value) => set({ deferredPrompt: value }),
   acceptTerms: () => {
     const user = get().currentUser;
     if (!user) return;
@@ -304,13 +298,13 @@ export const useStore = create<AppState>((set, get) => ({
     // í˜„ì¬ ì ‘ì†í•œ ë¸Œë¼ìš°ì €ì˜ URLì— ìˆëŠ” ì¿¼ë¦¬(query) íŒŒë¼ë¯¸í„°ë“¤ì„ íŒŒì‹±í•©ë‹ˆë‹¤.
     const urlParams = new URLSearchParams(window.location.search);
     // ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì¤‘ ì¶”ì²œì¸ ì½”ë“œ('ref')ê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ì—¬ ê°€ì ¸ì˜µë‹ˆë‹¤.
-    const refCode = urlParams.get('ref');
+    const refCode = urlParams.get('ref')?.trim().slice(0, 64) || null;
 
     // íŒŒì´ì–´ë² ì´ìŠ¤(ì—°ë™) ê¸°ëŠ¥ì´ í™œì„±í™”ë˜ì–´ í™˜ê²½ë³€ìˆ˜ë¡œ ë¡œë“œëœ ê²½ìš°ë§Œ ë¡œê·¸ì¸ ì‹œë„
     if (isFirebaseEnabled) {
       try {
         // ì¸ì•± ë¸Œë¼ìš°ì €(ì¸ìŠ¤íƒ€ê·¸ë¨, í˜ì´ìŠ¤ë¶, ì¹´ì¹´ì˜¤í†¡ ë“±) ê°ì§€ ë° ê²½ê³ 
-        const userAgent = navigator.userAgent || navigator.vendor || (window as any).opera;
+        const userAgent = [navigator.userAgent, navigator.vendor].filter(Boolean).join(' ');
         const isEmbeddedBrowser = /Instagram|FBAN|FBAV|Snapchat|Line|Kakao|Twitter|Threads/i.test(userAgent);
         if (isEmbeddedBrowser) {
           alert('ì¸ì•± ë¸Œë¼ìš°ì €ì—ì„œëŠ” êµ¬ê¸€ ë¡œê·¸ì¸ì´ ì°¨ë‹¨ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜¤ë¥¸ìª½ ìœ„ ë©”ë‰´(â‹®)ë¥¼ ëˆŒëŸ¬ ê¸°ë³¸ ë¸Œë¼ìš°ì €(Chrome/Safari)ë¡œ ì—´ì–´ì£¼ì„¸ìš”.\n\nIn-app browsers may block Google Login. Please open in Chrome/Safari.');
@@ -395,13 +389,15 @@ export const useStore = create<AppState>((set, get) => ({
           return;
         }
 
-      } catch (error: any) {
+      } catch (error: unknown) {
         // ë¡œê·¸ì¸ì´ ì‹¤íŒ¨í•˜ê±°ë‚˜ ì—¬ëŸ¬ ì´ìœ ë¡œ ì§„í–‰í•  ìˆ˜ ì—†ì—ˆì„ ë•Œ ë°œìƒ
         console.error('Google login failed:', error);
+        const message = error instanceof Error ? error.message : String(error);
+        const code = typeof error === 'object' && error && 'code' in error ? String((error as { code?: unknown }).code ?? '') : '';
 
         // 403 disallowed_useragent ì—ëŸ¬ (ë³´í†µ ì¸ì•± ë¸Œë¼ìš°ì € ë“±ì—ì„œ êµ¬ê¸€ì´ ì°¨ë‹¨í•  ë•Œ ë°œìƒ)
-        if (error?.message?.includes('disallowed_useragent') || error?.code === 'auth/unauthorized-domain' || error?.message?.includes('403') || error?.message?.includes('OAuth')) {
-          set({ showBrowserBlocker: true });
+        if (message.includes('disallowed_useragent') || code === 'auth/unauthorized-domain' || message.includes('403')) {
+          alert('ë³´ì•ˆìƒì˜ ì´ìœ ë¡œ í˜„ì¬ ë¸Œë¼ìš°ì €ì—ì„œëŠ” êµ¬ê¸€ ë¡œê·¸ì¸ì„ ì§„í–‰í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\nì˜¤ë¥¸ìª½ ìœ„ ë©”ë‰´(â‹®)ë¥¼ ëˆŒëŸ¬ ê¸°ë³¸ ë¸Œë¼ìš°ì €(Chrome/Safari)ë¡œ ì—´ì–´ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.\n\nGoogle Login is blocked in this browser. Please open in Chrome/Safari.');
         } else {
           alert('êµ¬ê¸€ ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.\nGoogle login failed. Please try again.');
         }
@@ -437,11 +433,15 @@ export const useStore = create<AppState>((set, get) => ({
   },
 
   logout: () => {
+    const unsub = get().rewardListenerUnsubscribe;
+    if (unsub) {
+      unsub();
+    }
     if (isFirebaseEnabled) {
       firebaseSignOut().catch(console.error);
     }
     safeStorage.set('stanbeat_user', null);
-    set({ currentUser: null, currentView: 'HOME', termsAccepted: false });
+    set({ currentUser: null, currentView: 'HOME', termsAccepted: false, rewardListenerUnsubscribe: null, videoWatchCount: 0 });
   },
 
   consumeHeart: () => {
@@ -475,11 +475,11 @@ export const useStore = create<AppState>((set, get) => ({
     if (!user || user.banned) return;
     const normalized = normalizeHearts(user);
     const record: HistoryEvent | null = amount > 0 ? { type: 'AD', value: amount, date: new Date().toISOString() } : null;
-    const nextHistory = record ? [...normalized.gameHistory, record] : normalized.gameHistory;
+    const nextHistory = (record ? [...normalized.gameHistory, record] : normalized.gameHistory).slice(-MAX_HISTORY_ITEMS);
 
     const updatedUser = {
       ...normalized,
-      hearts: normalized.hearts + amount,
+      hearts: Math.max(0, Math.min(MAX_HEARTS, normalized.hearts + amount)),
       expiresAt: Date.now() + THREE_HOURS,
       gameHistory: nextHistory,
     };
@@ -497,41 +497,32 @@ export const useStore = create<AppState>((set, get) => ({
   },
 
   // â”€â”€â”€ ì¼ì¼ í•˜íŠ¸ ì§€ê¸‰ ì²˜ë¦¬ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
-  claimDailyHeart: async () => {
+  claimDailyHeart: () => {
     const user = get().currentUser;
     if (!user || user.banned) return false;
     const normalized = normalizeHearts(user);
-
-    let todayStr = todayUtc();
-    try {
-      // Validate via un-spoofable public time API instead of local device clock
-      const res = await fetch('https://worldtimeapi.org/api/timezone/Etc/UTC');
-      const data = await res.json();
-      todayStr = data.datetime.slice(0, 10);
-    } catch {
-      // Silently fallback to device time if API is blocked/offline
-    }
-
-    if (normalized.lastDailyHeart === todayStr) {
+    if (normalized.lastDailyHeart === todayUtc()) {
       set({ currentUser: normalized });
       return false;
     }
     const record: HistoryEvent = { type: 'DAILY', value: 1, date: new Date().toISOString() };
     const updatedUser = {
       ...normalized,
-      hearts: Math.min(normalized.hearts + 1, 3),
-      lastDailyHeart: todayStr,
+      hearts: Math.min(normalized.hearts + 1, MAX_HEARTS),
+      lastDailyHeart: todayUtc(),
       expiresAt: Date.now() + THREE_HOURS,
-      gameHistory: [...normalized.gameHistory, record],
+      gameHistory: [...normalized.gameHistory, record].slice(-MAX_HISTORY_ITEMS),
     };
     safeStorage.set('stanbeat_user', updatedUser);
+    if (isFirebaseEnabled) {
+      saveUserProfile(updatedUser.id, { hearts: updatedUser.hearts, lastDailyHeart: updatedUser.lastDailyHeart }).catch(console.error);
+    }
     set({ currentUser: updatedUser });
     return true;
   },
 
   // â”€â”€â”€ ìµœê³  ê¸°ë¡ ê°±ì‹  ë° Firestore ì €ì¥ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   updateBestTime: (time) => {
-    // Basic debounce guard to prevent high-frequency physics spam updates
     if (time < 5000) {
       console.warn(`[Anti-Cheat] Rejected impossible time: ${time}ms`);
       return;
@@ -566,7 +557,7 @@ export const useStore = create<AppState>((set, get) => ({
     const user = get().currentUser;
     if (!user) return;
     const record: HistoryEvent = { type, value, date: new Date().toISOString() };
-    const nextUser = { ...user, gameHistory: [...user.gameHistory, record].slice(-100) };
+    const nextUser = { ...user, gameHistory: [...user.gameHistory, record].slice(-MAX_HISTORY_ITEMS) };
     safeStorage.set('stanbeat_user', nextUser);
     set({ currentUser: nextUser });
 
@@ -710,6 +701,7 @@ export const useStore = create<AppState>((set, get) => ({
   },
 
   banUser: (id) => {
+    if (!id) return;
     if (isFirebaseEnabled) {
       banUserInFs(id);
     }
@@ -720,28 +712,36 @@ export const useStore = create<AppState>((set, get) => ({
       user.id === id ? { ...user, banned: true } : user
     );
 
+    const currentUser = get().currentUser;
+    const nextCurrentUser = currentUser?.id === id ? { ...currentUser, banned: true } : currentUser;
+    if (nextCurrentUser) {
+      safeStorage.set('stanbeat_user', nextCurrentUser);
+    }
+
     safeStorage.set('stanbeat_leaderboard', combined);
-    set({ leaderboard: combined, adminUsers: updatedAdminUsers });
+    set({ leaderboard: combined, adminUsers: updatedAdminUsers, currentUser: nextCurrentUser ?? currentUser });
   },
 
   editUserHeart: (id, hearts) => {
+    if (!id || !Number.isFinite(hearts)) return;
+    const clampedHearts = Math.max(0, Math.min(MAX_HEARTS, Math.floor(hearts)));
     if (isFirebaseEnabled) {
-      editUserHeartInFirestore(id, hearts);
+      editUserHeartInFirestore(id, clampedHearts);
     }
 
     const user = get().currentUser;
     if (user && user.id === id) {
-      const updatedUser = { ...user, hearts: Math.max(0, Math.min(3, hearts)), expiresAt: Date.now() + THREE_HOURS };
+      const updatedUser = { ...user, hearts: clampedHearts, expiresAt: Date.now() + THREE_HOURS };
       safeStorage.set('stanbeat_user', updatedUser);
       set({ currentUser: updatedUser });
     }
 
     const combined = get().leaderboard.map((entry) =>
-      entry.id === id ? { ...entry, hearts: Math.max(0, Math.min(3, hearts)) } : entry
+      entry.id === id ? { ...entry, hearts: clampedHearts } : entry
     );
 
     const updatedAdminUsers = get().adminUsers.map(user =>
-      user.id === id ? { ...user, hearts: Math.max(0, Math.min(3, hearts)) } : user
+      user.id === id ? { ...user, hearts: clampedHearts } : user
     );
 
     safeStorage.set('stanbeat_leaderboard', combined);
@@ -750,8 +750,8 @@ export const useStore = create<AppState>((set, get) => ({
 
   getReferralLink: () => {
     const user = get().currentUser;
-    if (!user) return window.location.origin;
-    return `${window.location.origin}?ref=${user.referralCode}`;
+    if (!user) return window.location.href;
+    return `${window.location.origin}${window.location.pathname}?ref=${encodeURIComponent(user.referralCode)}`;
   },
 
   toggleAdminRole: () => {
@@ -790,7 +790,16 @@ export const useStore = create<AppState>((set, get) => ({
   // â”€â”€â”€ Ad System â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   setAdConfig: (partial) => {
     const current = get().adConfig;
-    const next = { ...current, ...partial };
+    const merged = { ...current, ...partial };
+    const next: AdConfig = {
+      rewardedVideo: Boolean(merged.rewardedVideo),
+      offerwall: Boolean(merged.offerwall),
+      interstitial: Boolean(merged.interstitial),
+      rewardedVideoSeconds: Math.max(5, Math.min(120, Math.floor(merged.rewardedVideoSeconds))),
+      offerwallRewardHearts: Math.max(1, Math.min(MAX_HEARTS, Math.floor(merged.offerwallRewardHearts))),
+      rewardedVideoRewardHearts: Math.max(1, Math.min(MAX_HEARTS, Math.floor(merged.rewardedVideoRewardHearts))),
+      videosPerHeart: Math.max(1, Math.min(20, Math.floor(merged.videosPerHeart))),
+    };
     safeStorage.set('stanbeat_ad_config', next);
     set({ adConfig: next });
   },
@@ -806,22 +815,22 @@ export const useStore = create<AppState>((set, get) => ({
 
   initAdscendListener: () => {
     const user = get().currentUser;
-    const existingUnsub = get().rewardListenerUnsubscribe;
     if (!user) return;
+
+    const existingUnsub = get().rewardListenerUnsubscribe;
     if (existingUnsub) {
       existingUnsub();
+      set({ rewardListenerUnsubscribe: null });
     }
 
     console.log('[Adscend] Initializing reward listener for', user.id);
-    // listenForRewards ì½œë°±: ìƒˆë¡œìš´ ê´‘ê³  ë³´ìƒ ìˆ˜ì‹  ì‹œ í•˜íŠ¸ ì§€ê¸‰ ë° Firestore ì²­êµ¬ ì²˜ë¦¬
     const unsub = listenForRewards(user.id, (reward) => {
       console.log('[Adscend] ìƒˆ ë³´ìƒ ìˆ˜ì‹ :', reward);
-      // ìœ ì €ì—ê²Œ í•˜íŠ¸ 1ê°œ ì§€ê¸‰
       get().addHeart(1);
-      // Firestoreì— ë³´ìƒ ì²­êµ¬ ì™„ë£Œ ê¸°ë¡ (ì´ì¤‘ ì§€ê¸‰ ë°©ì§€)
-      // rewardë¥¼ ëª…ì‹œì ìœ¼ë¡œ íƒ€ì… ìºìŠ¤íŒ…í•˜ì—¬ id ì†ì„±ì— ì•ˆì „í•˜ê²Œ ì ‘ê·¼
-      const { id: rewardId } = reward as { id: string };
-      claimRewardInFirestore(rewardId).catch(console.error);
+      const rewardId = typeof reward === 'object' && reward && 'id' in reward ? String((reward as { id?: unknown }).id ?? '') : '';
+      if (rewardId) {
+        claimRewardInFirestore(rewardId).catch(console.error);
+      }
     });
     set({ rewardListenerUnsubscribe: unsub });
   },
@@ -834,19 +843,24 @@ export const useStore = create<AppState>((set, get) => ({
       const user = get().currentUser;
       if (!user || user.banned) { resolve(false); return; }
 
+      const heartsReward = Math.max(1, Math.min(MAX_HEARTS, Math.floor(config.rewardedVideoRewardHearts)));
+      const videosPerHeart = Math.max(1, Math.floor(config.videosPerHeart));
       const nextCount = get().videoWatchCount + 1;
 
-      if (nextCount >= config.videosPerHeart) {
+      if (nextCount >= videosPerHeart) {
         // Reset count and grant heart
         const normalized = normalizeHearts(user);
-        const record: HistoryEvent = { type: 'AD', value: config.rewardedVideoRewardHearts, date: new Date().toISOString() };
+        const record: HistoryEvent = { type: 'AD', value: heartsReward, date: new Date().toISOString() };
         const updatedUser = {
           ...normalized,
-          hearts: Math.min(normalized.hearts + config.rewardedVideoRewardHearts, 3),
+          hearts: Math.min(normalized.hearts + heartsReward, MAX_HEARTS),
           expiresAt: Date.now() + THREE_HOURS,
-          gameHistory: [...normalized.gameHistory, record],
+          gameHistory: [...normalized.gameHistory, record].slice(-MAX_HISTORY_ITEMS),
         };
         const newRevenue = get().adRevenue + 0.35;
+        if (isFirebaseEnabled) {
+          incrementGlobalStats(0, 0.35);
+        }
         safeStorage.set('stanbeat_user', updatedUser);
         safeStorage.set('stanbeat_ad_revenue', newRevenue);
         set({ adRevenue: newRevenue, currentUser: updatedUser, videoWatchCount: 0 });
@@ -861,10 +875,10 @@ export const useStore = create<AppState>((set, get) => ({
 
   completeOfferwall: async () => {
     const config = get().adConfig;
-    if (!config.offerwall) return false;
+    const user = get().currentUser;
+    if (!config.offerwall || !user || user.banned) return false;
 
-    // Real offerwall rewards are handled by initAdscendListener + Firestore S2S Postback
-    // This function can be used to trigger an immediate check or analytics
+    get().addHeart(Math.max(1, Math.min(MAX_HEARTS, Math.floor(config.offerwallRewardHearts))));
     return true;
   },
 }));
diff --git a/utils.ts b/utils.ts
index 31e8d98..56d6541 100644
--- a/utils.ts
+++ b/utils.ts
@@ -5,50 +5,6 @@
 // ê·¸ë¦¬ë“œ ì…€/ë‹¨ì–´ ì„¤ì • íƒ€ì… ì„í¬íŠ¸ (types.tsì—ì„œ ì •ì˜ë¨)
 import { GridCell, WordConfig } from './types';
 
-// â”€â”€â”€ ì˜¤ë””ì˜¤ í•©ì„±ê¸° (SFX) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
-let audioCtx: AudioContext | null = null;
-export const playSfx = (type: 'tap' | 'found' | 'win') => {
-  try {
-    if (!audioCtx) audioCtx = new (window.AudioContext || (window as any).webkitAudioContext)();
-    if (audioCtx.state === 'suspended') audioCtx.resume();
-    const osc = audioCtx.createOscillator();
-    const gain = audioCtx.createGain();
-    osc.connect(gain);
-    gain.connect(audioCtx.destination);
-    const now = audioCtx.currentTime;
-
-    if (type === 'tap') {
-      osc.type = 'sine';
-      osc.frequency.setValueAtTime(600, now);
-      osc.frequency.exponentialRampToValueAtTime(300, now + 0.1);
-      gain.gain.setValueAtTime(0.1, now);
-      gain.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
-      osc.start(now);
-      osc.stop(now + 0.1);
-    } else if (type === 'found') {
-      osc.type = 'triangle';
-      osc.frequency.setValueAtTime(440, now);
-      osc.frequency.setValueAtTime(880, now + 0.1);
-      gain.gain.setValueAtTime(0.1, now);
-      gain.gain.linearRampToValueAtTime(0, now + 0.2);
-      osc.start(now);
-      osc.stop(now + 0.2);
-    } else if (type === 'win') {
-      osc.type = 'square';
-      osc.frequency.setValueAtTime(400, now);
-      osc.frequency.setValueAtTime(600, now + 0.1);
-      osc.frequency.setValueAtTime(800, now + 0.2);
-      osc.frequency.setValueAtTime(1200, now + 0.3);
-      gain.gain.setValueAtTime(0.1, now);
-      gain.gain.linearRampToValueAtTime(0, now + 0.5);
-      osc.start(now);
-      osc.stop(now + 0.5);
-    }
-  } catch (e) {
-    // Ignore audio errors on unsupported browsers or strict autoplay rules
-  }
-};
-
 // â”€â”€â”€ ì‹œê°„ í¬ë§·í„° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 // ë°€ë¦¬ì´ˆ ì •ìˆ˜ë¥¼ "MM:SS.CC" í˜•ì‹ì˜ ë¬¸ìì—´ë¡œ ë³€í™˜
 // ì˜ˆ: 75432ms â†’ "01:15.43"
@@ -142,48 +98,48 @@ const placeWord = (
 
 // â”€â”€â”€ ë‹¨ì–´ ì°¾ê¸° ê·¸ë¦¬ë“œ ìƒì„±ê¸° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
 // ì£¼ì–´ì§„ í¬ê¸°ì™€ ë‹¨ì–´ ëª©ë¡ìœ¼ë¡œ ë‹¨ì–´ ì°¾ê¸° ë³´ë“œë¥¼ ìƒì„±í•˜ëŠ” í•µì‹¬ í•¨ìˆ˜
-// ë¹ˆ ì¹¸ì´ ë„ˆë¬´ í•œìª½ìœ¼ë¡œ ì ë¦¬ì§€ ì•Šë„ë¡ ìµœì†Œ 3ë²ˆê¹Œì§€ ì¬ì‹œë„í•˜ëŠ” ì—”íŠ¸ë¡œí”¼ íŒ¨ìŠ¤ ì ìš©
+// ëŒ€ê°ì„  ë°©í–¥ë„ ì§€ì›í•˜ë©°, ë¹ˆ ì¹¸ì€ ëœë¤ ì•ŒíŒŒë²³ìœ¼ë¡œ ì±„ì›€
 export const generateGrid = (size: number, words: string[]) => {
-  let bestGrid: any = null;
-  let minEmptyRows = size;
-
-  for (let attempt = 0; attempt < 3; attempt++) {
-    const board: string[][] = Array(size).fill(null).map(() => Array(size).fill(''));
-    const placedWords: WordConfig[] = words.map(w => ({ word: w, found: false }));
-    const placement: PlacedWord[] = [];
-
-    words.forEach(word => {
-      let placed = false;
-      let attempts = 0;
-      while (!placed && attempts < 200) {
-        const dir = DIRECTIONS[Math.floor(Math.random() * DIRECTIONS.length)];
-        const row = Math.floor(Math.random() * size);
-        const col = Math.floor(Math.random() * size);
-        if (canPlaceWord(board, word, row, col, dir, size)) {
-          placement.push(placeWord(board, word, row, col, dir));
-          placed = true;
-        }
-        attempts++;
-      }
-    });
+  // size Ã— size í¬ê¸°ì˜ ë¹ˆ 2ì°¨ì› ë°°ì—´ ì´ˆê¸°í™” (ê° ì…€ì€ ë¹ˆ ë¬¸ìì—´)
+  const board: string[][] = Array(size).fill(null).map(() => Array(size).fill(''));
 
-    const emptyRows = board.filter(r => r.every(c => c === '')).length;
-    const currentGrid = { board, placedWords, placement, emptyRows };
+  // ëª¨ë“  ë‹¨ì–´ë¥¼ 'ì•„ì§ ëª» ì°¾ìŒ(found: false)' ìƒíƒœë¡œ ì´ˆê¸°í™”
+  const placedWords: WordConfig[] = words.map(w => ({ word: w, found: false }));
 
-    if (!bestGrid || emptyRows < minEmptyRows) {
-      bestGrid = currentGrid;
-      minEmptyRows = emptyRows;
-    }
+  // ê° ë‹¨ì–´ì˜ ë°°ì¹˜ ì •ë³´ë¥¼ ì €ì¥í•  ë°°ì—´ (ì •ë‹µ ê²€ì¦ ë° ìë™ í’€ê¸°ì— ì‚¬ìš©)
+  const placement: PlacedWord[] = [];
 
-    if (emptyRows <= 1) break; // Perfect spread, stop rolling
-  }
+  // â”€â”€â”€ ê° ë‹¨ì–´ ë°°ì¹˜ ì‹œë„ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
+  words.forEach(word => {
+    let placed = false;  // ì´ë²ˆ ë‹¨ì–´ê°€ ì„±ê³µì ìœ¼ë¡œ ë°°ì¹˜ë˜ì—ˆëŠ”ì§€ ì—¬ë¶€
+    let attempts = 0;    // ì‹œë„ íšŸìˆ˜ (ë¬´í•œ ë£¨í”„ ë°©ì§€)
 
-  const { board, placedWords, placement } = bestGrid;
+    while (!placed && attempts < 200) { // ìµœëŒ€ 200ë²ˆ ì‹œë„
+      // ëœë¤ ë°©í–¥ ì„ íƒ (ìˆ˜í‰/ìˆ˜ì§/ëŒ€ê°ì„  ì¤‘ í•˜ë‚˜)
+      const dir = DIRECTIONS[Math.floor(Math.random() * DIRECTIONS.length)];
+
+      // ëœë¤ ì‹œì‘ ìœ„ì¹˜ ì„ íƒ
+      const row = Math.floor(Math.random() * size);
+      const col = Math.floor(Math.random() * size);
+
+      // ë°°ì¹˜ ê°€ëŠ¥í•˜ë©´ ì‹¤ì œë¡œ ë°°ì¹˜í•˜ê³  ë£¨í”„ ì¢…ë£Œ
+      if (canPlaceWord(board, word, row, col, dir, size)) {
+        placement.push(placeWord(board, word, row, col, dir));
+        placed = true;
+      }
+      attempts++;
+    }
+    // 200ë²ˆ ì‹œë„ í›„ì—ë„ ë°°ì¹˜ ì‹¤íŒ¨ ì‹œ í•´ë‹¹ ë‹¨ì–´ëŠ” ê·¸ëƒ¥ ëˆ„ë½ë¨
+    // (ì‹¤ì œë¡œëŠ” 10Ã—10 ë³´ë“œì—ì„œ 7ê¸€ì ì´í•˜ ë‹¨ì–´ëŠ” ê±°ì˜ í•­ìƒ ì„±ê³µ)
+  });
 
   // â”€â”€â”€ ì…€ â†’ ë‹¨ì–´ ë§¤í•‘ êµ¬ì¶• â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
+  // "ì´ ì…€ì€ ì–´ë–¤ ë‹¨ì–´ì— ì†í•˜ëŠ”ê°€"ë¥¼ O(1)ë¡œ ì¡°íšŒí•˜ê¸° ìœ„í•œ Map
+  // key: "í–‰-ì—´" ë¬¸ìì—´, value: í•´ë‹¹ ì…€ì´ ì†í•œ ë‹¨ì–´
   const cellWordMap: Map<string, string> = new Map();
-  placement.forEach(({ word, row, col, dir }: PlacedWord) => {
+  placement.forEach(({ word, row, col, dir }) => {
     for (let i = 0; i < word.length; i++) {
+      // ê° ê¸€ìì˜ ì…€ IDë¥¼ í‚¤ë¡œ, ë‹¨ì–´ë¥¼ ê°’ìœ¼ë¡œ ì €ì¥
       cellWordMap.set(`${row + dir.r * i}-${col + dir.c * i}`, word);
     }
   });
